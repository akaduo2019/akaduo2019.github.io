---
title: 选课管理系统
date: 2020-11-14 17：40
tags:
- ProgrammingWeek
categories:
- python
---
app.py

```py
import sys

from PyQt5 import sip
from PyQt5.QtWidgets import *
from runlogin import Login


if __name__ == '__main__':
    app = QApplication(sys.argv)
    login = Login()
    login.show()
    sys.exit(app.exec_())
```

<!--more-->
***
icons_rc.qrc

```cs
<RCC>
  <qresource prefix="1">
    <file>icons/select_lesson.png</file>
    <file>icons/eye_on.png</file>
    <file>icons/eye_hide.png</file>
    <file>icons/window_icon.png</file>
    <file>icons/exit.png</file>
    <file>icons/增加课程.png</file>
    <file>icons/减少课程.png</file>
    <file>icons/重置.png</file>
    <file>icons/确认.png</file>
    <file>icons/更新.png</file>
    <file>icons/查询.png</file>
    <file>icons/管理员.png</file>
    <file>icons/学生.png</file>
    <file>icons/统计.png</file>
    <file>icons/选择.png</file>
    <file>icons/课程.png</file>
    <file>icons/设置.png</file>
    <file>icons/注册.png</file>
    <file>icons/班级.png</file>
    <file>icons/下拉.png</file>
  </qresource>
</RCC>
```

***
images.qrc

```cs
<RCC>
  <qresource prefix="image">
  <file>images/background.png</file>
  </qresource>
</RCC>
```

***
Login.py

```py
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        Dialog.setWindowModality(QtCore.Qt.WindowModal)
        Dialog.resize(1050, 750)
        Dialog.setMinimumSize(QtCore.QSize(1050, 750))
        Dialog.setMaximumSize(QtCore.QSize(1050, 750))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/1/icons/window_icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        Dialog.setWindowIcon(icon)
        Dialog.setStyleSheet("font: 10pt \"微软雅黑\";")
        self.gridLayout_5 = QtWidgets.QGridLayout(Dialog)
        self.gridLayout_5.setObjectName("gridLayout_5")
        self.tabWidget = QtWidgets.QTabWidget(Dialog)
        self.tabWidget.setMinimumSize(QtCore.QSize(550, 400))
        self.tabWidget.setMaximumSize(QtCore.QSize(550, 399))
        self.tabWidget.setStyleSheet("QPushButton{border-radius: 10px;border: 2px groove gray;border-style: outset;}\n"
"QPushButton:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QPushButton:pressed{color: #E680BD;}\n"
"QLineEdit{border:0px;margin:10px;border-bottom: 2px solid #B3B3B3}\n"
"QLineEdit:hover{border-bottom: 3px solid #66A3FF;}\n"
"QLineEdit:focus{border-bottom: 3px solid #E680BD;}\n"
"QTabBar::tab:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QTabBar::tab:selected{color: #E680BD;}\n"
"")
        self.tabWidget.setTabPosition(QtWidgets.QTabWidget.North)
        self.tabWidget.setTabShape(QtWidgets.QTabWidget.Rounded)
        self.tabWidget.setUsesScrollButtons(True)
        self.tabWidget.setDocumentMode(False)
        self.tabWidget.setTabsClosable(False)
        self.tabWidget.setTabBarAutoHide(False)
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.register_button_student = QtWidgets.QPushButton(self.tab)
        self.register_button_student.setGeometry(QtCore.QRect(185, 210, 101, 28))
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.register_button_student.sizePolicy().hasHeightForWidth())
        self.register_button_student.setSizePolicy(sizePolicy)
        self.register_button_student.setObjectName("register_button_student")
        self.login_button_student = QtWidgets.QPushButton(self.tab)
        self.login_button_student.setGeometry(QtCore.QRect(295, 210, 101, 28))
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.login_button_student.sizePolicy().hasHeightForWidth())
        self.login_button_student.setSizePolicy(sizePolicy)
        self.login_button_student.setObjectName("login_button_student")
        self.layoutWidget = QtWidgets.QWidget(self.tab)
        self.layoutWidget.setGeometry(QtCore.QRect(150, 90, 251, 111))
        self.layoutWidget.setObjectName("layoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.layoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label = QtWidgets.QLabel(self.layoutWidget)
        self.label.setObjectName("label")
        self.horizontalLayout.addWidget(self.label)
        self.account_input_student = QtWidgets.QLineEdit(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.account_input_student.sizePolicy().hasHeightForWidth())
        self.account_input_student.setSizePolicy(sizePolicy)
        self.account_input_student.setObjectName("account_input_student")
        self.horizontalLayout.addWidget(self.account_input_student)
        self.verticalLayout.addLayout(self.horizontalLayout)
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.label_2 = QtWidgets.QLabel(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_2.sizePolicy().hasHeightForWidth())
        self.label_2.setSizePolicy(sizePolicy)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout_3.addWidget(self.label_2)
        self.password_input_student = QtWidgets.QLineEdit(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.password_input_student.sizePolicy().hasHeightForWidth())
        self.password_input_student.setSizePolicy(sizePolicy)
        self.password_input_student.setObjectName("password_input_student")
        self.horizontalLayout_3.addWidget(self.password_input_student)
        self.verticalLayout.addLayout(self.horizontalLayout_3)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(":/1/icons/学生.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab, icon1, "")
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.login_button_admin = QtWidgets.QPushButton(self.tab_2)
        self.login_button_admin.setGeometry(QtCore.QRect(235, 210, 101, 28))
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.login_button_admin.sizePolicy().hasHeightForWidth())
        self.login_button_admin.setSizePolicy(sizePolicy)
        self.login_button_admin.setObjectName("login_button_admin")
        self.layoutWidget1 = QtWidgets.QWidget(self.tab_2)
        self.layoutWidget1.setGeometry(QtCore.QRect(150, 90, 251, 111))
        self.layoutWidget1.setObjectName("layoutWidget1")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.layoutWidget1)
        self.verticalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.label_4 = QtWidgets.QLabel(self.layoutWidget1)
        self.label_4.setObjectName("label_4")
        self.horizontalLayout_4.addWidget(self.label_4)
        self.account_input_admin = QtWidgets.QLineEdit(self.layoutWidget1)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.account_input_admin.sizePolicy().hasHeightForWidth())
        self.account_input_admin.setSizePolicy(sizePolicy)
        self.account_input_admin.setObjectName("account_input_admin")
        self.horizontalLayout_4.addWidget(self.account_input_admin)
        self.verticalLayout_2.addLayout(self.horizontalLayout_4)
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label_3 = QtWidgets.QLabel(self.layoutWidget1)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_2.addWidget(self.label_3)
        self.password_input_admin = QtWidgets.QLineEdit(self.layoutWidget1)
        self.password_input_admin.setObjectName("password_input_admin")
        self.horizontalLayout_2.addWidget(self.password_input_admin)
        self.verticalLayout_2.addLayout(self.horizontalLayout_2)
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap(":/1/icons/管理员.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab_2, icon2, "")
        self.gridLayout_5.addWidget(self.tabWidget, 0, 0, 1, 1)

        self.retranslateUi(Dialog)
        self.tabWidget.setCurrentIndex(0)
        self.login_button_student.clicked.connect(self.login_button_student.show)
        QtCore.QMetaObject.connectSlotsByName(Dialog)
        Dialog.setTabOrder(self.tabWidget, self.account_input_student)
        Dialog.setTabOrder(self.account_input_student, self.password_input_student)
        Dialog.setTabOrder(self.password_input_student, self.login_button_student)
        Dialog.setTabOrder(self.login_button_student, self.register_button_student)
        Dialog.setTabOrder(self.register_button_student, self.account_input_admin)
        Dialog.setTabOrder(self.account_input_admin, self.password_input_admin)
        Dialog.setTabOrder(self.password_input_admin, self.login_button_admin)

    def retranslateUi(self, Dialog):
        _translate = QtCore.QCoreApplication.translate
        Dialog.setWindowTitle(_translate("Dialog", "登陆"))
        self.register_button_student.setText(_translate("Dialog", "注册"))
        self.login_button_student.setText(_translate("Dialog", "登陆"))
        self.label.setText(_translate("Dialog", "账号:"))
        self.label_2.setText(_translate("Dialog", "密码:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("Dialog", "学生"))
        self.login_button_admin.setText(_translate("Dialog", "登陆"))
        self.label_4.setText(_translate("Dialog", "账号:"))
        self.label_3.setText(_translate("Dialog", "密码:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("Dialog", "教务"))
import icons_rc
import images_rc

```

***
runlogin.py

```py
import pymysql
import runmain_student

from PyQt5.QtWidgets import *
from PyQt5.QtGui import *
from Login import Ui_Dialog
from runmain_student import Main
from runmain_admin import MainAdmin
from runregister import Register


class Login(QDialog, Ui_Dialog):
    def __init__(self):
        super(Login, self).__init__()
        self.setupUi(self)

        # clicked信号绑定自定义槽login_to_main_student
        self.login_button_student.clicked.connect(self.login_to_main_student)
        # clicked信号绑定自定义槽login_to_main_admin
        self.login_button_admin.clicked.connect(self.login_to_main_admin)
        # clicked信号链接自定义槽jump_to_register_student
        self.register_button_student.clicked.connect(self.jump_to_register_student)

        # 设置密码文本框显示模式:输入时为密文显示
        self.password_input_student.setEchoMode(QLineEdit.Password)
        self.password_input_admin.setEchoMode(QLineEdit.Password)
    # 给登录窗口设置背景
    def paintEvent(self, event):
        painter = QPainter(self)
        pixmap = QPixmap("./images/background.png")
        painter.drawPixmap(self.rect(), pixmap)
    # 学生登陆界面跳转学生主界面
    def login_to_main_student(self):
        # 获取用户(学生)输入文本框内容,即账号密码
        account = self.account_input_student.text()
        password = self.password_input_student.text()

        # 打开数据库连接
        db = pymysql.connect("localhost", "root", "******", "management_system")
        # 使用cursor()方法获取操作游标
        cursor = db.cursor()
        # SQL 查询语句
        sql = "SELECT *FROM STUDENT_ACCOUNT "
        cursor.execute(sql)
        flag = False
        for row in cursor.fetchall():
            if account == row[0] and password == row[1]:
                flag = True
                break
        if flag:
            QMessageBox.information(self, "提示", "登陆成功")
            # 明确当前账户
            sql = "UPDATE NOW_ACCOUNT SET now_account=%s "
            cursor.execute(sql, account)
            db.commit()

            self.close()
            self.main_student = Main()
            self.main_student.show()



        else:
            QMessageBox.warning(self, "警告", "账号或密码输入错误，请重新输入")
            # 清空账号和密码的单行文本框
            self.account_input_student.clear()
            self.password_input_student.clear()

        cursor.close()
        db.close()

    # 教务登录界面跳转管理员主界面
    def login_to_main_admin(self):
        # 获取管理员账号和密码
        admin_user = self.account_input_admin.text()
        admin_password = self.password_input_admin.text()

        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()
        sql = "SELECT *FROM ADMIN_ACCOUNT"
        cursor.execute(sql)
        data = cursor.fetchone()
        if admin_user == data[0] and admin_password == data[1]:
            QMessageBox.information(self, "提示", "admin登录成功")
            self.close()
            self.main_admin = MainAdmin()
            self.main_admin.show()
        else:
            QMessageBox.warning(self, "警告", "admin账号或密码错误，请重新输入")
            self.account_input_student.clear()
            self.password_input_student.clear()

        cursor.close()
        db.close()

    # 学生登录界面跳转注册界面
    def jump_to_register_student(self):
        self.close()
        self.register = Register()
        self.register.show()

```

***
Main_admin.py

```py
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1200, 810)
        MainWindow.setMinimumSize(QtCore.QSize(1200, 810))
        MainWindow.setMaximumSize(QtCore.QSize(1200, 810))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/1/icons/window_icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        MainWindow.setWindowIcon(icon)
        MainWindow.setStyleSheet("font: 10pt \"微软雅黑\";")
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(270, 80, 860, 560))
        self.tabWidget.setMinimumSize(QtCore.QSize(860, 560))
        self.tabWidget.setMaximumSize(QtCore.QSize(860, 560))
        self.tabWidget.setStyleSheet("QPushButton{border-radius: 10px;border: 2px groove gray;border-style: outset;}\n"
"QPushButton:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QPushButton:pressed{color: #E680BD;}\n"
"QTabBar::tab:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QTabBar::tab:selected{color: #E680BD;}")
        self.tabWidget.setDocumentMode(True)
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.confirm_course_admin_button = QtWidgets.QPushButton(self.tab)
        self.confirm_course_admin_button.setGeometry(QtCore.QRect(740, 480, 101, 28))
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(":/1/icons/确认.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.confirm_course_admin_button.setIcon(icon1)
        self.confirm_course_admin_button.setObjectName("confirm_course_admin_button")
        self.admin_setcourse_tableWidget = QtWidgets.QTableWidget(self.tab)
        self.admin_setcourse_tableWidget.setGeometry(QtCore.QRect(110, 40, 611, 391))
        self.admin_setcourse_tableWidget.setObjectName("admin_setcourse_tableWidget")
        self.admin_setcourse_tableWidget.setColumnCount(1)
        self.admin_setcourse_tableWidget.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap(":/1/icons/选择.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        item.setIcon(icon2)
        self.admin_setcourse_tableWidget.setHorizontalHeaderItem(0, item)
        self.admin_add_button = QtWidgets.QPushButton(self.tab)
        self.admin_add_button.setGeometry(QtCore.QRect(740, 50, 101, 28))
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap(":/1/icons/增加课程.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.admin_add_button.setIcon(icon3)
        self.admin_add_button.setObjectName("admin_add_button")
        self.admin_del_button = QtWidgets.QPushButton(self.tab)
        self.admin_del_button.setGeometry(QtCore.QRect(740, 100, 101, 28))
        icon4 = QtGui.QIcon()
        icon4.addPixmap(QtGui.QPixmap(":/1/icons/减少课程.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.admin_del_button.setIcon(icon4)
        self.admin_del_button.setObjectName("admin_del_button")
        self.back_admin_button = QtWidgets.QPushButton(self.tab)
        self.back_admin_button.setGeometry(QtCore.QRect(20, 480, 101, 28))
        icon5 = QtGui.QIcon()
        icon5.addPixmap(QtGui.QPixmap(":/1/icons/exit.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.back_admin_button.setIcon(icon5)
        self.back_admin_button.setObjectName("back_admin_button")
        self.admin_reset_button = QtWidgets.QPushButton(self.tab)
        self.admin_reset_button.setGeometry(QtCore.QRect(740, 230, 101, 28))
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(":/1/icons/重置.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.admin_reset_button.setIcon(icon6)
        self.admin_reset_button.setObjectName("admin_reset_button")
        icon7 = QtGui.QIcon()
        icon7.addPixmap(QtGui.QPixmap(":/1/icons/设置.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab, icon7, "")
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.update_admin_button = QtWidgets.QPushButton(self.tab_2)
        self.update_admin_button.setGeometry(QtCore.QRect(370, 50, 93, 28))
        icon8 = QtGui.QIcon()
        icon8.addPixmap(QtGui.QPixmap(":/1/icons/更新.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.update_admin_button.setIcon(icon8)
        self.update_admin_button.setObjectName("update_admin_button")
        self.admin_display_tableWidget = QtWidgets.QTableWidget(self.tab_2)
        self.admin_display_tableWidget.setGeometry(QtCore.QRect(0, 110, 851, 421))
        self.admin_display_tableWidget.setObjectName("admin_display_tableWidget")
        self.admin_display_tableWidget.setColumnCount(0)
        self.admin_display_tableWidget.setRowCount(5)
        item = QtWidgets.QTableWidgetItem()
        self.admin_display_tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.admin_display_tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.admin_display_tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.admin_display_tableWidget.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.admin_display_tableWidget.setVerticalHeaderItem(4, item)
        icon9 = QtGui.QIcon()
        icon9.addPixmap(QtGui.QPixmap(":/1/icons/统计.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab_2, icon9, "")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(70, 70, 201, 231))
        self.label.setText("")
        self.label.setPixmap(QtGui.QPixmap(":/1/icons/管理员.png"))
        self.label.setObjectName("label")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1200, 29))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)
        MainWindow.setTabOrder(self.confirm_course_admin_button, self.update_admin_button)
        MainWindow.setTabOrder(self.update_admin_button, self.admin_display_tableWidget)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "教务管理"))
        self.confirm_course_admin_button.setText(_translate("MainWindow", "确认"))
        item = self.admin_setcourse_tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "选择栏"))
        self.admin_add_button.setText(_translate("MainWindow", "增加课程"))
        self.admin_del_button.setText(_translate("MainWindow", "删除课程"))
        self.back_admin_button.setText(_translate("MainWindow", "退出"))
        self.admin_reset_button.setText(_translate("MainWindow", "重置"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "课程设置"))
        self.update_admin_button.setText(_translate("MainWindow", "更新"))
        item = self.admin_display_tableWidget.verticalHeaderItem(0)
        item.setText(_translate("MainWindow", "1班"))
        item = self.admin_display_tableWidget.verticalHeaderItem(1)
        item.setText(_translate("MainWindow", "2班"))
        item = self.admin_display_tableWidget.verticalHeaderItem(2)
        item.setText(_translate("MainWindow", "3班"))
        item = self.admin_display_tableWidget.verticalHeaderItem(3)
        item.setText(_translate("MainWindow", "4班"))
        item = self.admin_display_tableWidget.verticalHeaderItem(4)
        item.setText(_translate("MainWindow", "总人数"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "选课统计"))
import icons_rc

```

***
runmain_admin.py

```py
import pymysql
import re

from PyQt5.QtWidgets import *
from Main_admin import Ui_MainWindow


class MainAdmin(QMainWindow, Ui_MainWindow):
    def __init__(self):
        super(MainAdmin, self).__init__()
        self.setupUi(self)
        self.setStyleSheet('''QWidget#MainWindow{border-image: url(./images/background.png)}''')
        # 信号与槽的绑定
        self.confirm_course_admin_button.clicked.connect(self.admin_set_course)
        self.update_admin_button.clicked.connect(self.admin_statistics)
        self.back_admin_button.clicked.connect(self.admin_to_login)
        self.admin_add_button.clicked.connect(self.add_course)
        self.admin_del_button.clicked.connect(self.delete_course)
        self.admin_reset_button.clicked.connect(self.reset_all)

        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()

        # 选课设置板块的初始化
        # 设置选课设置板块表格行数，即教务可设置几门课程
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(27)
        self.admin_setcourse_tableWidget.setRowCount(len(info_schedule))
        # 设置垂直方向的表头标签
        labels = []
        for i in range(0, len(info_schedule)):
            labels.append("课程"+info_schedule[i][0])
        self.admin_setcourse_tableWidget.setVerticalHeaderLabels(labels)
        # 设置表格水平方向自适应
        self.admin_setcourse_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
        # 为表格添加下拉组合框
        for i in range(0, len(info_schedule)):
            combobox = QComboBox()
            # 为每个下拉组合框预设四个默认可选选项并设置为可编辑,并且设置当前下标为-1
            combobox.addItems(['程设', '马原', '毛概', '邓论'])
            combobox.setEditable(True)
            combobox.setCurrentIndex(-1)
            # 为每个下拉组合框重新命名
            combobox.setObjectName(str(i))
            # 将每个下拉组合框添加到表格中
            self.admin_setcourse_tableWidget.setCellWidget(i, 0, combobox)
        # 如果教务之前已经设置过课程，则登录进教务界面时显示它们
        flag = False
        for i in range(0, len(info_schedule)):
            if info_schedule[i][-1] != '':
                flag = True
                break
        if flag:
            for i in range(0, len(info_schedule)):
                if info_schedule[i][-1] != '':
                    self.findChild(QComboBox, str(i)).setCurrentText(info_schedule[i][-1])

        # 初始化教务选课版信息
        try:
            courses = []
            for i in range(0, len(info_schedule)):
                if info_schedule[i][-1] != '':
                    courses.append(info_schedule[i][-1])
            # 设置表格列数
            self.admin_display_tableWidget.setColumnCount(len(courses))
            # 设置表格水平表头标签，即教务设置的课程名
            self.admin_display_tableWidget.setHorizontalHeaderLabels(courses)
        except:
            print(69)
        # 禁止table widget的编辑
        self.admin_display_tableWidget.setEditTriggers(QAbstractItemView.NoEditTriggers)
        # 水平方向自适应
        self.admin_display_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)

        cursor.close()
        db.close()

    # 教务界面的设置课程模块
    def admin_set_course(self):
        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()
        # 当教务按下选课设置页面的确定按钮时，student_account表中的course和class字段内容应该被清空
        try:
            sql = 'update student_account set course=null'
            cursor.execute(sql)
            sql = 'update student_account set class=null'
            cursor.execute(sql)
            db.commit()
        except:
            print(87)

        try:
            sql = 'select *from schedule'
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(94)
        # 获取当前下拉组合框中的课程名
        course_names = []
        for i in range(0, len(info_schedule)):
            course_names.append(self.findChild(QComboBox, str(i)).currentText())
        # 判断当前下拉组合框中的课程名是否至少有一门课程不为空
        flag = False
        for i in range(0, len(info_schedule)):
            if course_names[i] != '':
                flag = True
                break
        if not flag:
            QMessageBox.information(self, "提示", "至少设置一门课程")
        else:
            # 判断当前下拉组合框中的课程名是否重复
            flag = True
            for i in range(0, len(info_schedule)-1):
                for j in range(i+1, len(info_schedule)):
                    if course_names[i] == course_names[j] and course_names[i] != '' and course_names[j] != '':
                        flag = False
                        break
            if not flag:
               QMessageBox.information(self, "提示", "不能设置两门相同的课程")
            else:
                # 更新表schedule中的course字段内容
                for i in range(0, len(info_schedule)):
                    try:
                        sql = 'update schedule set course=%s where id=%s'
                        data = (course_names[i], str(i+1))
                        cursor.execute(sql, data)
                        db.commit()
                    except:
                        print(102)
                QMessageBox.information(self, "提示", "课程设置成功")
        cursor.close()
        db.close()

    # 教务界面的选课版模块
    def admin_statistics(self):
        # 存储人数
        num = []
        total_num = []
        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()

        # 重新设置后,点击更新按钮，统计版的标题头应该被刷新
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(154)
        try:
            courses = []
            for i in range(0, len(info_schedule)):
                if info_schedule[i][-1] != '':
                    courses.append(info_schedule[i][-1])
            # 设置表格列数
            self.admin_display_tableWidget.setColumnCount(len(courses))
            # 设置表格水平表头标签，即教务设置的课程名
            self.admin_display_tableWidget.setHorizontalHeaderLabels(courses)
        except:
            print(165)

        # 用i遍历不同的班
        for i in range(0, 4):
            try:
                sql = "select *from student_account where class=%s"
                cursor.execute(sql, str(i+1)+'班')
                info = cursor.fetchall()
                if info is not None:
                    # 创建一个列表counts,存储该班每门课对应人数
                    counts = []
                    # 为每门课初始人数赋值为0
                    for k in range(0, len(courses)):
                        counts.append(0)
                    # 用j遍历同班中每个人的course字段内容
                    for j in range(0, len(info)):
                        # 用k遍历courses列表中的课，即教务预设的课
                        for k in range(0, len(courses)):
                            # 使用正则表达式检索course字段中的内容，发现这门课在该字符串中，则这门课的人数加一
                            if re.search(courses[k], info[j][-1]) is not None:
                                counts[k] = counts[k] + 1
                    for k in range(0, len(courses)):
                        num.append(counts[k])
            except:
                print(189)

        # 统计各课程总人数
        for col in range(0, len(courses)):
            # count用于存储每个课程的总人数
            count = 0
            for row in range(0, 4):
                count = count + num[row*len(courses)+col]
            total_num.append(count)

        # 将统计好的各班各课程人数显示在选课版的表格上
        for row in range(0, 5):
            for col in range(0, len(courses)):
                if row == 4:
                    item = QTableWidgetItem(str(total_num[col]))
                    self.admin_display_tableWidget.setItem(row, col, item)
                else:
                    item = QTableWidgetItem(str(num[len(courses)*row+col]))
                    self.admin_display_tableWidget.setItem(row, col, item)
        cursor.close()
        db.close()

    # 教务界面增加课程
    def add_course(self):
        # 在教务添加课程之前提示"请先保存未确认的课程，再添加课程"
        reply = QMessageBox.information(self, "提示", "请先保存未确认的课程，再添加课程", QMessageBox.Ok | QMessageBox.Abort,
                                        QMessageBox.Abort)
        if reply == QMessageBox.Ok:
            db = pymysql.connect("localhost", "root", "******", "management_system")
            cursor = db.cursor()
            # 当教务按下增加课程按钮并选择Ok时，student_account表中的course和class字段内容应该被清空
            try:
                sql = 'update student_account set course=null'
                cursor.execute(sql)
                sql = 'update student_account set class=null'
                cursor.execute(sql)
                db.commit()
            except:
                print(227)
            # 获取添加课程之前已经有多少门课程
            try:
                sql = 'select *from schedule'
                cursor.execute(sql)
                info_schedule = cursor.fetchall()
            except:
                print(241)
            # 如果课程小于9门则可以继续添加,否则提示不能再添加更多课程
            if len(info_schedule) < 9:
                # 往表schedule插入一条记录
                try:
                    sql = 'insert into schedule(id, course) values(%s, %s)'
                    data = (str(len(info_schedule)+1), '')
                    cursor.execute(sql, data)
                    db.commit()
                except:
                    print(249)

                # 刷新教务界面设置课程的表格
                try:
                    sql = "select *from schedule"
                    cursor.execute(sql)
                    info_schedule = cursor.fetchall()
                except:
                    print(259)
                self.admin_setcourse_tableWidget.setRowCount(len(info_schedule))
                # 设置垂直方向的表头标签
                labels = []
                for i in range(0, len(info_schedule)):
                    labels.append("课程"+info_schedule[i][0])
                self.admin_setcourse_tableWidget.setVerticalHeaderLabels(labels)
                # 设置表格水平方向自适应
                self.admin_setcourse_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
                # 为表格添加下拉组合框
                for i in range(0, len(info_schedule)):
                    combobox = QComboBox()
                    # 为每个下拉组合框预设四个默认可选选项并设置为可编辑,并且设置当前下标为-1
                    combobox.addItems(['程设', '马原', '毛概', '邓论'])
                    combobox.setEditable(True)
                    combobox.setCurrentIndex(-1)
                    # 为每个下拉组合框重新命名
                    combobox.setObjectName(str(i))
                    # 将每个下拉组合框添加到表格中
                    self.admin_setcourse_tableWidget.setCellWidget(i, 0, combobox)
                # 如果教务之前已经设置过课程，则登录进教务界面时显示它们
                flag = False
                for i in range(0, len(info_schedule)):
                    if info_schedule[i][-1] != '':
                        flag = True
                        break
                if flag:
                    for i in range(0, len(info_schedule)):
                        if info_schedule[i][-1] != '':
                            self.findChild(QComboBox, str(i)).setCurrentText(info_schedule[i][-1])
            else:
                QMessageBox.information(self, "提示", "添加课程已到上限")

            cursor.close()
            db.close()
    # 教务界面删除课程
    def delete_course(self):
        # 在教务添加课程之前提示"请先保存未确认的课程，再添加课程"
        reply = QMessageBox.information(self, "提示", "请先保存未确认的课程，再删除课程", QMessageBox.Ok | QMessageBox.Abort,
                                        QMessageBox.Abort)
        if reply == QMessageBox.Ok:
            db = pymysql.connect("localhost", "root", "******", "management_system")
            cursor = db.cursor()
            # 当教务按下删除课程按钮并选择Ok时，student_account表中的course和class字段内容应该被清空
            try:
                sql = 'update student_account set course=null'
                cursor.execute(sql)
                sql = 'update student_account set class=null'
                cursor.execute(sql)
                db.commit()
            except:
                print(304)
            # 获取添加课程之前已经有多少门课程
            try:
                sql = 'select *from schedule'
                cursor.execute(sql)
                info_schedule = cursor.fetchall()
            except:
                print(264)
            # 如果之前的课程大于四门则可以删除，否则提示不能再继续删除
            if len(info_schedule) > 4:
                # 在表schedule中删除最后一条记录
                try:
                    sql = 'delete from schedule where id=%s'
                    cursor.execute(sql, len(info_schedule))
                    db.commit()
                except:
                    print(273)

                # 刷新教务界面设置课程的表格
                try:
                    sql = "select *from schedule"
                    cursor.execute(sql)
                    info_schedule = cursor.fetchall()
                except:
                    print(320)
                self.admin_setcourse_tableWidget.setRowCount(len(info_schedule))
                # 设置垂直方向的表头标签
                labels = []
                for i in range(0, len(info_schedule)):
                    labels.append("课程" + info_schedule[i][0])
                self.admin_setcourse_tableWidget.setVerticalHeaderLabels(labels)
                # 设置表格水平方向自适应
                self.admin_setcourse_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
                # 为表格添加下拉组合框
                for i in range(0, len(info_schedule)):
                    combobox = QComboBox()
                    # 为每个下拉组合框预设四个默认可选选项并设置为可编辑,并且设置当前下标为-1
                    combobox.addItems(['程设', '马原', '毛概', '邓论'])
                    combobox.setEditable(True)
                    combobox.setCurrentIndex(-1)
                    # 为每个下拉组合框重新命名
                    combobox.setObjectName(str(i))
                    # 将每个下拉组合框添加到表格中
                    self.admin_setcourse_tableWidget.setCellWidget(i, 0, combobox)
                # 如果教务之前已经设置过课程，则登录进教务界面时显示它们
                flag = False
                for i in range(0, len(info_schedule)):
                    if info_schedule[i][-1] != '':
                        flag = True
                        break
                if flag:
                    for i in range(0, len(info_schedule)):
                        if info_schedule[i][-1] != '':
                            self.findChild(QComboBox, str(i)).setCurrentText(info_schedule[i][-1])
            else:
                QMessageBox.information(self, "提示", "不能再继续删除课程")

    # 教务界面重置按钮
    def reset_all(self):
        reply = QMessageBox.information(self, "提示", "将重置整个选课系统为初始状态!", QMessageBox.Yes | QMessageBox.No
                                        , QMessageBox.No)
        if reply == QMessageBox.Yes:
            db = pymysql.connect("localhost", "root", "******", "management_system")
            cursor = db.cursor()
            # 清空表schedule的course字段，并删除id大于4的记录
            try:
                sql = 'select *from schedule'
                cursor.execute(sql)
                info_schedule = cursor.fetchall()
                if len(info_schedule) > 4:
                    for i in range(5, len(info_schedule)+1):
                        sql = 'delete from schedule where id=%s'
                        cursor.execute(sql, str(i))
                        db.commit()
                sql = 'update schedule set course=%s'
                cursor.execute(sql, '')
                db.commit()
            except:
                print(385)
            # 清空表student_account中的class和course字段
            try:
                sql = 'update student_account set class = null'
                cursor.execute(sql)
                sql = 'update student_account set course = null'
                cursor.execute(sql)
                db.commit()
            except:
                print(399)
        # 设置教务设置课程界面为初始状态
        # 选课设置板块的初始化
        # 设置选课设置板块表格行数，即教务可设置几门课程
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(27)
        self.admin_setcourse_tableWidget.setRowCount(len(info_schedule))
        # 设置垂直方向的表头标签
        labels = []
        for i in range(0, len(info_schedule)):
            labels.append("课程" + info_schedule[i][0])
        self.admin_setcourse_tableWidget.setVerticalHeaderLabels(labels)
        # 设置表格水平方向自适应
        self.admin_setcourse_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
        # 为表格添加下拉组合框
        for i in range(0, len(info_schedule)):
            combobox = QComboBox()
            # 为每个下拉组合框预设四个默认可选选项并设置为可编辑,并且设置当前下标为-1
            combobox.addItems(['程设', '马原', '毛概', '邓论'])
            combobox.setEditable(True)
            combobox.setCurrentIndex(-1)
            # 为每个下拉组合框重新命名
            combobox.setObjectName(str(i))
            # 将每个下拉组合框添加到表格中
            self.admin_setcourse_tableWidget.setCellWidget(i, 0, combobox)
        cursor.close()
        db.close()

    # 教务界面返回登录界面
    def admin_to_login(self):
        from runlogin import Login
        self.close()
        self.login = Login()
        self.login.show()

```

***
Main_student.py

```py
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setWindowModality(QtCore.Qt.ApplicationModal)
        MainWindow.resize(1200, 810)
        MainWindow.setMinimumSize(QtCore.QSize(1200, 810))
        MainWindow.setMaximumSize(QtCore.QSize(1200, 810))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/1/icons/window_icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        MainWindow.setWindowIcon(icon)
        MainWindow.setStyleSheet("font: 10pt \"微软雅黑\";")
        MainWindow.setUnifiedTitleAndToolBarOnMac(False)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(270, 80, 860, 560))
        self.tabWidget.setMinimumSize(QtCore.QSize(860, 560))
        self.tabWidget.setMaximumSize(QtCore.QSize(860, 560))
        self.tabWidget.setStyleSheet("QPushButton{border-radius: 10px;border: 2px groove gray;border-style: outset;}\n"
"QPushButton:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QPushButton:pressed{color: #E680BD;}\n"
"QTabBar::tab:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QTabBar::tab:selected{color: #E680BD;}\n"
"QComboBox{border:2px solid}\n"
"QComboBox::hover{ border:2px solid #E680BD;color: #66A3FF;}\n"
"QComboBox::pressed{color: #ca1028;}\n"
"")
        self.tabWidget.setDocumentMode(True)
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.student_update_button = QtWidgets.QPushButton(self.tab)
        self.student_update_button.setGeometry(QtCore.QRect(750, 470, 101, 31))
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(":/1/icons/确认.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.student_update_button.setIcon(icon1)
        self.student_update_button.setObjectName("student_update_button")
        self.student_back = QtWidgets.QPushButton(self.tab)
        self.student_back.setGeometry(QtCore.QRect(0, 470, 101, 31))
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap(":/1/icons/exit.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.student_back.setIcon(icon2)
        self.student_back.setObjectName("student_back")
        self.student_setcourse_tableWidget = QtWidgets.QTableWidget(self.tab)
        self.student_setcourse_tableWidget.setGeometry(QtCore.QRect(0, 60, 851, 381))
        self.student_setcourse_tableWidget.setStyleSheet("")
        self.student_setcourse_tableWidget.setObjectName("student_setcourse_tableWidget")
        self.student_setcourse_tableWidget.setColumnCount(2)
        self.student_setcourse_tableWidget.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap(":/1/icons/选择.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        item.setIcon(icon3)
        self.student_setcourse_tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        icon4 = QtGui.QIcon()
        icon4.addPixmap(QtGui.QPixmap(":/1/icons/课程.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        item.setIcon(icon4)
        self.student_setcourse_tableWidget.setHorizontalHeaderItem(1, item)
        self.layoutWidget = QtWidgets.QWidget(self.tab)
        self.layoutWidget.setGeometry(QtCore.QRect(0, 20, 161, 31))
        self.layoutWidget.setObjectName("layoutWidget")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.layoutWidget)
        self.horizontalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.stu_set_class_label = QtWidgets.QLabel(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.stu_set_class_label.sizePolicy().hasHeightForWidth())
        self.stu_set_class_label.setSizePolicy(sizePolicy)
        self.stu_set_class_label.setObjectName("stu_set_class_label")
        self.horizontalLayout_2.addWidget(self.stu_set_class_label)
        self.stu_set_class_comboBox = QtWidgets.QComboBox(self.layoutWidget)
        self.stu_set_class_comboBox.setObjectName("stu_set_class_comboBox")
        self.stu_set_class_comboBox.addItem("")
        self.stu_set_class_comboBox.addItem("")
        self.stu_set_class_comboBox.addItem("")
        self.stu_set_class_comboBox.addItem("")
        self.horizontalLayout_2.addWidget(self.stu_set_class_comboBox)
        icon5 = QtGui.QIcon()
        icon5.addPixmap(QtGui.QPixmap(":/1/icons/select_lesson.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab, icon5, "")
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.update_information = QtWidgets.QPushButton(self.tab_2)
        self.update_information.setGeometry(QtCore.QRect(720, 30, 93, 28))
        icon6 = QtGui.QIcon()
        icon6.addPixmap(QtGui.QPixmap(":/1/icons/更新.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.update_information.setIcon(icon6)
        self.update_information.setObjectName("update_information")
        self.student_display_tableWidget = QtWidgets.QTableWidget(self.tab_2)
        self.student_display_tableWidget.setGeometry(QtCore.QRect(0, 80, 851, 451))
        self.student_display_tableWidget.setObjectName("student_display_tableWidget")
        self.student_display_tableWidget.setColumnCount(1)
        self.student_display_tableWidget.setRowCount(5)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setVerticalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setVerticalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.student_display_tableWidget.setHorizontalHeaderItem(0, item)
        icon7 = QtGui.QIcon()
        icon7.addPixmap(QtGui.QPixmap(":/1/icons/统计.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab_2, icon7, "")
        self.tab_3 = QtWidgets.QWidget()
        self.tab_3.setObjectName("tab_3")
        self.student_find_button = QtWidgets.QPushButton(self.tab_3)
        self.student_find_button.setGeometry(QtCore.QRect(370, 120, 101, 31))
        icon8 = QtGui.QIcon()
        icon8.addPixmap(QtGui.QPixmap(":/1/icons/查询.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.student_find_button.setIcon(icon8)
        self.student_find_button.setObjectName("student_find_button")
        self.display_student_information = QtWidgets.QTextBrowser(self.tab_3)
        self.display_student_information.setGeometry(QtCore.QRect(270, 170, 291, 241))
        self.display_student_information.setObjectName("display_student_information")
        self.tabWidget.addTab(self.tab_3, icon8, "")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(70, 70, 201, 231))
        self.label.setText("")
        self.label.setPixmap(QtGui.QPixmap(":/1/icons/学生.png"))
        self.label.setObjectName("label")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1200, 29))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(0)
        self.stu_set_class_comboBox.setCurrentIndex(-1)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)
        MainWindow.setTabOrder(self.student_update_button, self.student_back)
        MainWindow.setTabOrder(self.student_back, self.update_information)
        MainWindow.setTabOrder(self.update_information, self.student_find_button)
        MainWindow.setTabOrder(self.student_find_button, self.student_display_tableWidget)
        MainWindow.setTabOrder(self.student_display_tableWidget, self.display_student_information)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "学生选课系统"))
        self.student_update_button.setText(_translate("MainWindow", "确认"))
        self.student_back.setText(_translate("MainWindow", "退出"))
        item = self.student_setcourse_tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "选择"))
        item = self.student_setcourse_tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "课程"))
        self.stu_set_class_label.setText(_translate("MainWindow", "班级:"))
        self.stu_set_class_comboBox.setItemText(0, _translate("MainWindow", "1班"))
        self.stu_set_class_comboBox.setItemText(1, _translate("MainWindow", "2班"))
        self.stu_set_class_comboBox.setItemText(2, _translate("MainWindow", "3班"))
        self.stu_set_class_comboBox.setItemText(3, _translate("MainWindow", "4班"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "学生选课"))
        self.update_information.setText(_translate("MainWindow", "更新"))
        item = self.student_display_tableWidget.verticalHeaderItem(0)
        item.setText(_translate("MainWindow", "1班"))
        item = self.student_display_tableWidget.verticalHeaderItem(1)
        item.setText(_translate("MainWindow", "2班"))
        item = self.student_display_tableWidget.verticalHeaderItem(2)
        item.setText(_translate("MainWindow", "3班"))
        item = self.student_display_tableWidget.verticalHeaderItem(3)
        item.setText(_translate("MainWindow", "4班"))
        item = self.student_display_tableWidget.verticalHeaderItem(4)
        item.setText(_translate("MainWindow", "总人数"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "选课统计"))
        self.student_find_button.setText(_translate("MainWindow", "查询"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_3), _translate("MainWindow", "选课查询"))
import icons_rc
import images_rc

```

***
runmain_student.py

```py
import pymysql
import re

from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5.QtCore import Qt
from Main_student import Ui_MainWindow


class Main(QMainWindow, Ui_MainWindow):
    def __init__(self):
        super(Main, self).__init__()
        self.setupUi(self)
        self.setStyleSheet('''#MainWindow{border-image: url(./images/background.png)}''')

        # 自定义槽与clicked信号
        self.student_update_button.clicked.connect(self.succeed_choose_course) # 确认选课按钮
        self.student_back.clicked.connect(self.main_student_to_login) # 返回按钮
        self.update_information.clicked.connect(self.statistics_course_student) # 更新选课版信息
        self.student_find_button.clicked.connect(self.display_information) #查询按钮

        # 初始化学生选课表格
        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()
        # 获取教务预设的课程
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(33)
        # 创建一个列表courses，存放教务预设的课程
        courses = []
        for i in range(0, len(info_schedule)):
            if info_schedule[i][-1] != '':
                courses.append(info_schedule[i][-1])
        # 设置学生选课表格的行数
        self.student_setcourse_tableWidget.setRowCount(len(courses))
        # 设置学生选课表格垂直表头标签
        labels = []
        for i in range(0, len(courses)):
            labels.append(str(i+1))
        self.student_setcourse_tableWidget.setVerticalHeaderLabels(labels)
        # 设置表格水平方向自适应
        self.student_setcourse_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
        # 为学生选课表格的每一行的第一列创建复选框checkbox
        for i in range(0, len(courses)):
            checkbox = QCheckBox()
            # 设置复选框初始状态为未选中
            checkbox.setChecked(False)
            # 为复选框重新命名
            checkbox.setObjectName(str(i))
            # 将复选框添加到学生选课表格中
            self.student_setcourse_tableWidget.setCellWidget(i, 0, checkbox)
        # 为学生选课表格每一行的第二列初始化教务设置的课程
        for i in range(0, len(courses)):
            item = QTableWidgetItem(courses[i])
            self.student_setcourse_tableWidget.setItem(i, 1, item)
        # 将学生选课表格设置为禁止编辑
        self.student_setcourse_tableWidget.setEditTriggers(QAbstractItemView.NoEditTriggers)

        # 初始化学生选课版表格信息
        # 设置水平标题栏和列数
        try:
            self.student_display_tableWidget.setColumnCount(len(courses))
            self.student_display_tableWidget.setHorizontalHeaderLabels(courses)
        except:
            print(67)
        # 将表格设置为禁止编辑
        self.student_display_tableWidget.setEditTriggers(QAbstractItemView.NoEditTriggers)
        # 水平方向自适应
        self.student_display_tableWidget.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)

        cursor.close()
        db.close()

    # 学生选课成功，将学生信息录入模块
    def succeed_choose_course(self):
        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()
        # 获取教务预设的课程
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(86)
        # 创建一个列表courses，存放教务预设的课程
        courses = []
        for i in range(0, len(info_schedule)):
            if info_schedule[i][-1] != '':
                courses.append(info_schedule[i][-1])
        # 若没有选择班级，则提示"请先选择班级"
        if self.stu_set_class_comboBox.currentText() == '':
            QMessageBox.information(self, "提示", "请先选择班级")
        else:
            # 若所有复选框都没被选择，则提示"请至少选择一门课程"
            flag = False
            for i in range(0, len(courses)):
                if self.findChild(QCheckBox, str(i)).isChecked() == True:
                    flag = True
                    break
            if not flag:
                QMessageBox.information(self, "提示", "请至少选择一门课程")
            else:
                # 将学生选择的班级和课程录入表student_account的中的class字段和course字段中
                # 查找当前账户
                try:
                    sql = 'select *from now_account'
                    cursor.execute(sql)
                    user = cursor.fetchone()
                except:
                    print(112)
                # 录入学生班级
                try:
                    sql = 'update student_account set class=%s where account=%s'
                    data = (self.stu_set_class_comboBox.currentText(), user[0])
                    cursor.execute(sql, data)
                    db.commit()
                except:
                    print(118)
                # 录入学生选择的课程
                # 创建一个空字符串stu_courses存储这个学生选择的所有课程
                stu_courses = ""
                for i in range(0, len(courses)):
                    if self.findChild(QCheckBox, str(i)).isChecked() == True:
                        stu_courses = stu_courses + courses[i] + ';'
                try:
                    sql = 'update student_account set course=%s where account=%s'
                    data = (stu_courses, user[0])
                    cursor.execute(sql, data)
                    db.commit()
                except:
                    print(133)
                # 提示选课成功
                QMessageBox.information(self, "提示", "选课成功")

        cursor.close()
        db.close()

    # 学生界面选课版,点击刷新按钮，统计选课情况
    def statistics_course_student(self):
        # 存储人数
        num = []
        total_num = []
        db = pymysql.connect("localhost", "root", "******", "management_system")
        cursor = db.cursor()

        # 重新设置后,点击更新按钮，统计版的标题头应该被刷新
        try:
            sql = "select *from schedule"
            cursor.execute(sql)
            info_schedule = cursor.fetchall()
        except:
            print(112)
        try:
            courses = []
            for i in range(0, len(info_schedule)):
                if info_schedule[i][-1] != '':
                    courses.append(info_schedule[i][-1])
            # 设置表格列数
            self.student_display_tableWidget.setColumnCount(len(courses))
            # 设置表格水平表头标签，即教务设置的课程名
            self.student_display_tableWidget.setHorizontalHeaderLabels(courses)
        except:
            print(132)

        # 用i遍历不同的班
        for i in range(0, 4):
            try:
                sql = "select *from student_account where class=%s"
                cursor.execute(sql, str(i + 1) + '班')
                info = cursor.fetchall()
                if info is not None:
                    # 创建一个列表counts,存储该班每门课对应人数
                    counts = []
                    # 为每门课初始人数赋值为0
                    for k in range(0, len(courses)):
                        counts.append(0)
                    # 用j遍历同班中每个人的course字段内容
                    for j in range(0, len(info)):
                        # 用k遍历courses列表中的课，即教务预设的课
                        for k in range(0, len(courses)):
                            # 使用正则表达式检索course字段中的内容，发现这门课在该字符串中，则这门课的人数加一
                            if re.search(courses[k], info[j][-1]) is not None:
                                counts[k] = counts[k] + 1
                    for k in range(0, len(courses)):
                        num.append(counts[k])
            except:
                print(192)

        # 统计各课程总人数
        for col in range(0, len(courses)):
            # count用于存储每个课程的总人数
            count = 0
            for row in range(0, 4):
                count = count + num[row * len(courses) + col]
            total_num.append(count)

        # 将统计好的各班各课程人数显示在选课版的表格上
        for row in range(0, 5):
            for col in range(0, len(courses)):
                if row == 4:
                    item = QTableWidgetItem(str(total_num[col]))
                    self.student_display_tableWidget.setItem(row, col, item)
                else:
                    item = QTableWidgetItem(str(num[len(courses) * row + col]))
                    self.student_display_tableWidget.setItem(row, col, item)
        cursor.close()
        db.close()

    # 学生查询模块
    def display_information(self):
        db = pymysql.connect('localhost', 'root', '******', 'management_system')
        cursor = db.cursor()

        # 每次点击查询按钮都要清空之前的内容
        self.display_student_information.clear()
        # 获取当前操作账户
        try:
            sql = "select *from now_account"
            cursor.execute(sql)
            user = cursor.fetchone()
        except:
            print(250)
        # 获取该账户所有信息
        try:
            sql = "select *from student_account where account = %s"
            cursor.execute(sql, user[0])
            info_user = cursor.fetchone()
        except:
            print(257)

        # 显示所选班级
        if info_user[2] is None:
            self.display_student_information.append("班级:未选")
            self.display_student_information.ensureCursorVisible()
            self.display_student_information.append(" ")
            self.display_student_information.ensureCursorVisible()
        else:
            self.display_student_information.append("班级:" + info_user[2])
            self.display_student_information.ensureCursorVisible()
            self.display_student_information.append(" ")
            self.display_student_information.ensureCursorVisible()
        # 显示所选课程
        if info_user[-1] is None:
            self.display_student_information.append("未选一门课程")
        else:
            self.display_student_information.append("已选课程:")
            self.display_student_information.ensureCursorVisible()
            self.display_student_information.append(info_user[-1])


        cursor.close()
        db.close()

    # 学生选课界面返回按钮,跳转回登录界面
    def main_student_to_login(self):
        from runlogin import Login

        self.close()
        self.login = Login()
        self.login.show()
```

***
register.py

```py
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        Dialog.resize(1050, 750)
        Dialog.setMinimumSize(QtCore.QSize(1050, 750))
        Dialog.setMaximumSize(QtCore.QSize(1050, 750))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/1/icons/window_icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        Dialog.setWindowIcon(icon)
        Dialog.setStyleSheet("font: 10pt \"微软雅黑\";")
        Dialog.setSizeGripEnabled(False)
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout(Dialog)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.tabWidget = QtWidgets.QTabWidget(Dialog)
        self.tabWidget.setMinimumSize(QtCore.QSize(550, 400))
        self.tabWidget.setMaximumSize(QtCore.QSize(550, 400))
        self.tabWidget.setStyleSheet("QPushButton{border-radius: 10px;border: 2px groove gray;border-style: outset;}\n"
"QPushButton:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QPushButton:pressed{color: #E680BD;}\n"
"QLineEdit{border:0px;margin:10px;border-bottom: 2px solid #B3B3B3}\n"
"QLineEdit:hover{border-bottom: 3px solid #66A3FF;}\n"
"QLineEdit:focus{border-bottom: 3px solid #E680BD;}\n"
"QTabBar::tab:hover{color: #66A3FF;background:qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #fafafa, stop: 0.4 #f4f4f4,stop: 0.5 #e7e7e7, stop: 1.0 #fafafa);}\n"
"QTabBar::tab:selected{color: #E680BD;}")
        self.tabWidget.setDocumentMode(False)
        self.tabWidget.setTabsClosable(False)
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.register_exit_button = QtWidgets.QPushButton(self.tab)
        self.register_exit_button.setGeometry(QtCore.QRect(150, 220, 93, 28))
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.register_exit_button.sizePolicy().hasHeightForWidth())
        self.register_exit_button.setSizePolicy(sizePolicy)
        self.register_exit_button.setObjectName("register_exit_button")
        self.register_confirm_button = QtWidgets.QPushButton(self.tab)
        self.register_confirm_button.setGeometry(QtCore.QRect(310, 220, 93, 28))
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.register_confirm_button.sizePolicy().hasHeightForWidth())
        self.register_confirm_button.setSizePolicy(sizePolicy)
        self.register_confirm_button.setObjectName("register_confirm_button")
        self.layoutWidget = QtWidgets.QWidget(self.tab)
        self.layoutWidget.setGeometry(QtCore.QRect(151, 126, 235, 49))
        self.layoutWidget.setObjectName("layoutWidget")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.layoutWidget)
        self.horizontalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label_2 = QtWidgets.QLabel(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_2.sizePolicy().hasHeightForWidth())
        self.label_2.setSizePolicy(sizePolicy)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout_2.addWidget(self.label_2)
        self.password_register_input = QtWidgets.QLineEdit(self.layoutWidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.password_register_input.sizePolicy().hasHeightForWidth())
        self.password_register_input.setSizePolicy(sizePolicy)
        self.password_register_input.setObjectName("password_register_input")
        self.horizontalLayout_2.addWidget(self.password_register_input)
        self.layoutWidget1 = QtWidgets.QWidget(self.tab)
        self.layoutWidget1.setGeometry(QtCore.QRect(151, 81, 235, 49))
        self.layoutWidget1.setObjectName("layoutWidget1")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.layoutWidget1)
        self.horizontalLayout.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label = QtWidgets.QLabel(self.layoutWidget1)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label.sizePolicy().hasHeightForWidth())
        self.label.setSizePolicy(sizePolicy)
        self.label.setObjectName("label")
        self.horizontalLayout.addWidget(self.label)
        self.account_register_input = QtWidgets.QLineEdit(self.layoutWidget1)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.account_register_input.sizePolicy().hasHeightForWidth())
        self.account_register_input.setSizePolicy(sizePolicy)
        self.account_register_input.setObjectName("account_register_input")
        self.horizontalLayout.addWidget(self.account_register_input)
        self.layoutWidget2 = QtWidgets.QWidget(self.tab)
        self.layoutWidget2.setGeometry(QtCore.QRect(152, 173, 269, 49))
        self.layoutWidget2.setObjectName("layoutWidget2")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout(self.layoutWidget2)
        self.horizontalLayout_3.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.label_3 = QtWidgets.QLabel(self.layoutWidget2)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_3.sizePolicy().hasHeightForWidth())
        self.label_3.setSizePolicy(sizePolicy)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_3.addWidget(self.label_3)
        self.re_password_register_input = QtWidgets.QLineEdit(self.layoutWidget2)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.re_password_register_input.sizePolicy().hasHeightForWidth())
        self.re_password_register_input.setSizePolicy(sizePolicy)
        self.re_password_register_input.setObjectName("re_password_register_input")
        self.horizontalLayout_3.addWidget(self.re_password_register_input)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(":/1/icons/注册.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.tabWidget.addTab(self.tab, icon1, "")
        self.horizontalLayout_4.addWidget(self.tabWidget)

        self.retranslateUi(Dialog)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(Dialog)
        Dialog.setTabOrder(self.account_register_input, self.password_register_input)
        Dialog.setTabOrder(self.password_register_input, self.register_confirm_button)
        Dialog.setTabOrder(self.register_confirm_button, self.register_exit_button)

    def retranslateUi(self, Dialog):
        _translate = QtCore.QCoreApplication.translate
        Dialog.setWindowTitle(_translate("Dialog", "注册"))
        self.register_exit_button.setText(_translate("Dialog", "退出"))
        self.register_confirm_button.setText(_translate("Dialog", "确认注册"))
        self.label_2.setText(_translate("Dialog", "密码:"))
        self.label.setText(_translate("Dialog", "账号:"))
        self.label_3.setText(_translate("Dialog", "重复密码:"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("Dialog", "学生注册"))
import icons_rc

```

***
runregister.py

```py
import pymysql

from PyQt5.QtWidgets import *
from PyQt5.QtGui import*
from register import Ui_Dialog


class Register(QDialog, Ui_Dialog):

    def __init__(self):
        super(Register, self).__init__()
        self.setupUi(self)

        # clicked信号绑定自定义槽jump_to_login
        self.register_confirm_button.clicked.connect(self.jump_to_login)
        # clicked信号链接自定义槽from_register_to_login
        self.register_exit_button.clicked.connect(self.from_register_to_login)
    # 给注册窗口设置背景
    def paintEvent(self, event):
        painter = QPainter(self)
        pixmap = QPixmap("./images/background.png")
        painter.drawPixmap(self.rect(), pixmap)
    # 注册确认,跳转到登陆界面
    def jump_to_login(self):

        from runlogin import Login

        # 获取注册的账号，密码以及重复密码
        account = self.account_register_input.text()
        password = self.password_register_input.text()
        re_password = self.re_password_register_input.text()

        # 如果账号为空，则重新输入
        if account == "" or password == "":
            QMessageBox.warning(self, "警告", "账号密码不能为空，请重新输入")
            self.account_register_input.clear()
            self.password_register_input.clear()
            self.re_password_register_input.clear()

        else:
            db = pymysql.connect("localhost", "root", "******", "management_system")
            cursor = db.cursor()
            sql = "SELECT *FROM STUDENT_ACCOUNT "
            cursor.execute(sql)
            # flag=False代表用户名不重复，flag=True代表用户名重复
            flag = False
            for row in cursor.fetchall():
                if account == row[0]:
                    flag = True
                    break
            # 如果用户名重复
            if flag:
                QMessageBox.warning(self, "警告", "账户名已存在，请重新注册")
                self.account_register_input.clear()
                self.password_register_input.clear()
                self.re_password_register_input.clear()

            else:
                if password != re_password:
                    QMessageBox.warning(self, "警告", "两次输入密码不一致，请重新输入")
                    self.account_register_input.clear()
                    self.password_register_input.clear()
                    self.re_password_register_input.clear()
                else:
                    # 向数据库中插入新的账户和密码
                    try:
                        sql = "insert into student_account(account, password) values(%s, %s)"
                        data = (account, password)
                        cursor.execute(sql, data)
                        db.commit()  # 提交
                    except:
                        print(77)
                    cursor.close()
                    db.close()

                    QMessageBox.information(self, "提示", "注册成功，请重新登录")
                    self.close()
                    self.main_student = Login()
                    self.main_student.show()

    # 学生注册界面点击退出按钮跳转回到登录界面
    def from_register_to_login(self):
        from runlogin import Login

        self.close()
        self.login = Login()
        self.login.show()

```
